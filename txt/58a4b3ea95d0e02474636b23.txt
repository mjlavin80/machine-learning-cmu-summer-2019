The opinion of the United States Court of Appeals for the Ninth Circuit upholding the temporary restraining order against President Trump’s travel ban has received a fair amount of criticism from legal experts. They point out that the president enjoys considerable legal authority to take immigration-related actions. But the experts miss the larger significance of the opinion. It is less a conventional statement of legal reasoning than an indication that the courts have woken up to the dangers of the Trump presidency. The courts now must confront a question: Can they face down President Trump without undermining their own standing? Mr. Trump’s travel ban originally barred all foreigners from seven countries in the Middle East from the United States. The executive order was sloppily written, and the rollout was a mess. After much confusion, the administration excluded green-card holders from the ban. That left various visa holders and other foreigners. The president claimed that his legal authority could hardly be clearer. A statute authorizes the president to “suspend the entry of all aliens or any class of aliens” if he finds that their presence “would be detrimental to the interests of the United States.” The Ninth Circuit held that the travel ban violated the due-process rights of aliens. While it may be true that green-card holders (and certain temporarily admitted aliens) cannot be blocked from entry based on a general “national interest” determination, the due-process rights of other foreigners not already on American soil are exceedingly limited. For this group of aliens, the travel ban did not violate due-process rights. The court could have given Mr. Trump an easy victory by protecting only green-card holders (and the temporarily admitted aliens) from the ban, as the government suggested it do. The court refused because the government failed to make clear in the executive order that green-card holders would be exempted. But this is a non sequitur. As the respected former federal appellate judge Michael McConnell notes, the ban’s challengers were legally entitled to a judicial order that blocked only illegal portions of the ban. By resting on due process, the court was able to block the travel ban without addressing a more explosive argument. The court noted that “the states have offered evidence of numerous statements by the president about his intent to implement a ‘Muslim ban,’ ” but declined to resolve this claim “in light of the sensitive interests involved.” The “sensitive interests” did not hold back a Federal District Court in Virginia. In an opinion issued on Monday, the court ruled that the president acted with animus against Muslims when he issued the travel ban. The court laid out the damning evidence: the campaign statement calling for a Muslim ban, which is still on the web; Rudolph Giuliani’s acknowledgment that the travel ban was really a Muslim ban; the failure of the lawyers who wrote the ban to consult national-security officials; and Mr. Trump’s statements in interviews. This is surely the first time in history that a court has found that a president acted out of bigotry. Yet the ruling contradicts the Supreme Court’s admonition that courts may not “look behind” a “facially legitimate” reason — here, the national security interest in stricter vetting — when the president exercises immigration authority. Does this mean President Trump is right to complain that the courts are political? Not exactly. The courts were playing politics, but of a valid constitutional kind. Judges are human beings who read newspapers as well as briefs. They know about Mr. Trump’s reckless and erratic behavior — indeed, they have been on the receiving end of it. After losing the lower court case in Washington State, President Trump called the judge, James L. Robart, a “so-called judge.” The president later tweeted, “If something happens blame him and court system.” With hardly a pause, President Trump implied that the Ninth Circuit was biased (“I won’t call it biased,” he said. “But courts seem to be so political”) before it decided the case. In another tweet, he blasted the judges for their “disgraceful decision.” James Madison rooted the separation of powers in the “personal motives” of the officers in one branch “to resist encroachments” of the other branches. If one branch attacks another, the latter will attack back. Weren’t the Ninth Circuit panel and the Virginia court acting in good Madisonian fashion? Mr. Trump warns that if the courts constantly look over his shoulder, he won’t be able to protect us from security threats. The Virginia court, having established Mr. Trump’s bigotry, has placed him on probation, preparing the way for challenges to any future executive actions against Muslim countries. But the blame lies with Mr. Trump. Having used the pretext of national security to indulge his hostility to a vulnerable group and lacking self-discipline and professionalism, he has lost the confidence of the courts, just as he may have lost the confidence of intelligence agents he compared to Nazis. The president’s authority rests on trust and discretion, not on triumph of the will. But there is a problem: Courts have historically deferred to the president on national-security matters because the president acts on the basis of classified information and may need to move quickly. If courts are now creating a “Trump exception” to settled law on presidential powers, we should also remember that our safety depends on a return to the era in which the courts — and intelligence agents — trusted the president’s word. And if a terrorist attack does happen, as the president suggested in a tweet, he might feel empowered to defy the courts. While we might celebrate the court’s alertness to its institutional prerogatives, we should also be aware of the high stakes and risks in this clash between the executive and the judiciary.
The attackers based their weapon on vulnerabilities that were stolen from the National Security Agency.